{"version":3,"sources":["webpack:///./src/components/Comments.vue?693f","webpack:///src/components/Comments.vue","webpack:///./src/components/Comments.vue?f0bc","webpack:///./src/components/Comments.vue","webpack:///./src/components/Comments.vue?80a2"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","_v","_s","commentsCount","_l","key","id","staticClass","user_name","parent","parent_name","_e","ctime","comments","on","$event","preventDefault","huifu","directives","name","rawName","value","expression","domProps","target","composing","email","comment","inputRandomCode","randomSvg","changeCode","sendComment","staticRenderFns","data","commentList","rightCode","parentName","computed","methods","window","scrollTo","document","body","scrollHeight","axios","url","method","toLowerCase","alert","initData","getBid","$store","commit","getComments","bid","watch","$route","created","component"],"mappings":"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","file":"js/chunk-a6b7b1ec.d035040f.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{attrs:{\"id\":\"blogComment\"}},[_c('span',[_vm._v(_vm._s(_vm.commentsCount)+\" Comments\")]),_c('ul',_vm._l((_vm.commentList),function(key){return _c('li',{key:key.id},[_c('span',{staticClass:\"user_name\"},[_vm._v(\" \"+_vm._s(key.user_name)+\": \"),(key.parent == 1)?_c('span',{staticClass:\"user_name\"},[_vm._v(\"@\"+_vm._s(key.parent_name))]):_vm._e()]),_c('span',{staticClass:\"date\"},[_vm._v(_vm._s(key.ctime))]),_c('p',[_vm._v(\" \"+_vm._s(key.comments)+\" \"),_c('span',{staticClass:\"res\",on:{\"click\":function($event){$event.preventDefault();return _vm.huifu(key.user_name)}}},[_vm._v(\"[回复]\")])])])}),0)]),_c('div',{staticClass:\"addComment\",attrs:{\"id\":\"addComment\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.name),expression:\"name\"}],attrs:{\"type\":\"text\",\"placeholder\":\"Nick Name\"},domProps:{\"value\":(_vm.name)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.name=$event.target.value}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.email),expression:\"email\"}],attrs:{\"type\":\"text\",\"placeholder\":\"Email\"},domProps:{\"value\":(_vm.email)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.email=$event.target.value}}}),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.comment),expression:\"comment\"}],attrs:{\"placeholder\":\"content\"},domProps:{\"value\":(_vm.comment)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.comment=$event.target.value}}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.inputRandomCode),expression:\"inputRandomCode\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.inputRandomCode)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.inputRandomCode=$event.target.value}}}),_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.randomSvg)},on:{\"click\":_vm.changeCode}}),_c('button',{on:{\"click\":_vm.sendComment}},[_vm._v(\"提交留言\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <div id=\"blogComment\">\n      <span>{{commentsCount}} Comments</span>\n      <ul>\n        <li v-for=\"(key) of commentList\" :key=\"key.id\">\n          <!-- 点击回复时把此评论的name传入，设置addComment的parentName -->\n          <span class=\"user_name\">\n            {{key.user_name}}:\n            <span v-if=\"key.parent == 1\" class=\"user_name\">@{{key.parent_name}}</span>\n          </span>\n          <span class=\"date\">{{key.ctime}}</span>\n          <p>\n            {{key.comments}}\n            <span class=\"res\" @click.prevent=\"huifu(key.user_name)\">[回复]</span>\n          </p>\n        </li>\n      </ul>\n    </div>\n    <div class=\"addComment\" id=\"addComment\">\n      <!-- <input type=\"hidden\" v-model=\"commentId\"> -->\n      <input type=\"text\" placeholder=\"Nick Name\" v-model=\"name\" />\n      <input type=\"text\" placeholder=\"Email\" v-model=\"email\" />\n      <textarea placeholder=\"content\" v-model=\"comment\"></textarea>\n      <input type=\"text\" v-model=\"inputRandomCode\" />\n      <span v-html=\"randomSvg\" v-on:click=\"changeCode\"></span>\n      <button @click=\"sendComment\">提交留言</button>\n    </div>\n  </div>\n</template>\n<script>\nlet axios = require(\"axios\");\nimport { mapState } from \"vuex\";\nexport default {\n  data() {\n    return {\n      commentList: [],\n      commentsCount: 0,\n      randomSvg: \"\",\n      rightCode: \"\",\n      // commentId: 0,\n      name: \"\",\n      email: \"\",\n      comment: \"\",\n      inputRandomCode: \"\",\n      parentName: \"0\",\n      parent: -1\n      // bid: null\n    };\n  },\n  computed:{\n    ...mapState(['bid'])\n  },\n  methods: {\n    huifu(parentName) {\n      this.parent = 1;\n      this.parentName = parentName;\n      window.scrollTo(0, document.body.scrollHeight);\n      //   location.href = \"#addComment\";\n    },\n    changeCode() {\n      axios({\n        url: \"/getRandomCode\",\n        method: \"get\"\n      })\n        .then(resp => {\n          this.randomSvg = resp.data.data.data;\n          this.rightCode = resp.data.data.text;\n        })\n        .catch(e => {\n          console.log(e);\n        });\n    },\n    sendComment() {\n      if (\n        this.name == \"\" ||\n        this.email == \"\" ||\n        this.comment == \"\" ||\n        this.inputRandomCode == \"\"\n      ) {\n        alert(\"内容不能为空\");\n        return;\n      }\n      if (this.inputRandomCode.toLowerCase() != this.rightCode.toLowerCase()) {\n        alert(\"验证码错误\");\n        return;\n      }\n      // about的bid固定为-1\n\n      axios({\n        url:\n          \"/sendComment?bid=\" +\n          this.bid +\n          \"&parent=\" +\n          this.parent +\n          \"&name=\" +\n          this.name +\n          \"&email=\" +\n          this.email +\n          \"&comment=\" +\n          this.comment +\n          \"&parentName=\" +\n          this.parentName,\n        method: \"get\"\n      }).then(() => {\n        alert(\"留言成功\");\n        // 此处想要触发vue重新渲染\n        this.getComments();\n        // location.reload();\n      });\n    },\n    initData() {\n      this.commentList = [];\n      this.commentsCount = 0;\n      this.randomSvg = \"\";\n      this.rightCode = \"\";\n      // commentId= 0;\n      this.name = \"\";\n      this.email = \"\";\n      this.comment = \"\";\n      this.inputRandomCode = \"\";\n      this.parentName = \"0\";\n      this.parent = -1;\n      // this.bid = null;\n    },\n    getBid() {\n      // 每次get都需要把之前的内容清空\n      // this._data不可迭代，没办法,只能手动了\n      this.initData();\n      // if (this.$route.query.bid) {\n      //   this.bid = this.$route.query.bid;\n      // } \n      if (\n        this.$route.path == \"/about\" ||\n        this.$route.path == \"/guestbook\"\n      ) {\n        // this.bid = -1;\n        this.$store.commit('changeBid', -1);\n      }\n    },\n    getComments() {\n      this.getBid();\n      axios({\n        url: \"/getCommentsByBlogId?bid=\" + this.bid,\n        method: \"get\"\n      }).then(resp => {\n        this.commentList = resp.data.data;\n      });\n      axios({\n        url: \"/getCommentsCountByBlogId?bid=\" + this.bid,\n        method: \"get\"\n      }).then(resp => {\n        this.commentsCount = resp.data.data[0].count;\n      });\n      this.changeCode();\n    }\n  },\n  watch: {\n    $route: \"getComments\"\n  },\n  created() {\n    //！！！！！\n    //   此处拿bid需要修改\n    this.getComments();\n    // 拿comments\n  }\n};\n</script>\n<style scoped>\n#blogComment {\n  width: 100%;\n  margin: 20px 0px 0px 0px;\n  opacity: 0.9;\n  background: #fff;\n  box-shadow: 4px 4px 4px;\n  padding: 20px 10px 20px 10px;\n  box-sizing: border-box;\n  border-radius: 8px;\n}\n\n#blogComment ul {\n  width: 98%;\n}\n\n#blogComment .user_name {\n  font-weight: 600;\n}\n\n#blogComment .date {\n  float: right;\n  margin-right: 10px;\n}\n#blogComment .res {\n  font-weight: 600;\n  float: right;\n  margin-right: 10px;\n  color: #008c8c;\n  cursor: pointer;\n}\n#blogComment ul li {\n  list-style: none;\n  background: #d9edf7;\n  border: 1px dashed #7ca4c1;\n  margin: 10px 0px 0px 0px;\n  padding: 10px 0px 10px 10px;\n  border-radius: 5px;\n}\n\n#blogComment ul li span {\n  /* background: pink; */\n  padding: 5px 0px 5px 10px;\n}\n\n#blogComment ul li p {\n  margin: 20px 0px 0px 10px;\n}\n\n.addComment {\n  margin-top: 20px;\n  box-shadow: 4px 4px 4px;\n  width: 100%;\n  border: 1px solid grey;\n  background: #fff;\n  opacity: 0.9;\n  border-radius: 8px;\n  box-sizing: border-box;\n}\n\n.addComment input {\n  width: 300px;\n  height: 30px;\n  border-radius: 5px;\n  margin: 15px 0px 5px 10px;\n  outline: none;\n  padding-left: 5px;\n}\n\n.addComment textarea {\n  width: 620px;\n  height: 100px;\n  margin: 5px 0px 5px 10px;\n  font-size: 16px;\n  padding: 5px 5px 5px 5px;\n  resize: none;\n}\n\n.addComment button {\n  display: block;\n  width: 100px;\n  background: white;\n  margin: 5px 0px 10px 10px;\n  height: 30px;\n  cursor: pointer;\n  border: 1px solid grey;\n  border-radius: 4px;\n}\n\n#addComment > span {\n  cursor: pointer;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comments.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comments.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Comments.vue?vue&type=template&id=2368228a&scoped=true&\"\nimport script from \"./Comments.vue?vue&type=script&lang=js&\"\nexport * from \"./Comments.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Comments.vue?vue&type=style&index=0&id=2368228a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2368228a\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comments.vue?vue&type=style&index=0&id=2368228a&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comments.vue?vue&type=style&index=0&id=2368228a&scoped=true&lang=css&\""],"sourceRoot":""}